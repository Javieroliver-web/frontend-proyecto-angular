<!-- src/app/pages/project-list/project-list.html -->
<div class="project-list-container">
  
  <!-- Cabecera con bot√≥n de crear -->
  <div class="page-header">
    <h1 class="page-title">Mis Proyectos</h1>
    <button class="btn btn-primary" (click)="abrirModal()">+ Crear Proyecto</button>
  </div>

  <!-- Mensaje de error global -->
  <div *ngIf="errorMessage" class="error-message">
    {{ errorMessage }}
    <button (click)="errorMessage = ''" style="float: right; background: none; border: none; cursor: pointer;">√ó</button>
  </div>

  <!-- Proyectos Favoritos -->
  <section class="section-proyectos-favoritos">
    <h2 class="section-title">‚≠ê Proyectos Favoritos</h2>
    
    <div *ngIf="isLoadingFavoritos" class="loading-container">
      <div class="spinner"></div>
      <p>Cargando favoritos...</p>
    </div>

    <div *ngIf="!isLoadingFavoritos && proyectosFavoritos.length > 0" class="project-cards-grid">
      <div 
        *ngFor="let proyecto of proyectosFavoritos" 
        class="project-card project-card-favorito">
        
        <!-- Bot√≥n de favorito -->
        <button 
          class="btn-favorito active" 
          (click)="toggleFavorito(proyecto, $event)"
          title="Quitar de favoritos"
          type="button">
          ‚≠ê
        </button>

        <!-- Contenido clickeable -->
        <div class="card-content" [routerLink]="['/board']" [queryParams]="{id: proyecto.id}">
          <span class="card-icon">{{ getIcono(proyecto) }}</span>
          <h3>{{ proyecto.nombre }}</h3>
          <p *ngIf="proyecto.descripcion" class="project-description">{{ proyecto.descripcion }}</p>
          <span class="favorito-badge">‚≠ê Favorito</span>
        </div>
      </div>
    </div>

    <div *ngIf="!isLoadingFavoritos && proyectosFavoritos.length === 0" class="empty-state">
      <p>‚ú® No tienes proyectos favoritos a√∫n</p>
      <p class="hint">Marca tus proyectos favoritos haciendo clic en la estrella ‚≠ê</p>
    </div>
  </section>

  <!-- Todos los Proyectos -->
  <section class="section-todos-proyectos">
    <h2 class="section-title">üìÇ Todos los proyectos</h2>
    
    <div *ngIf="isLoading" class="loading-container">
      <div class="spinner"></div>
      <p>Cargando proyectos...</p>
    </div>

    <div *ngIf="!isLoading && proyectos.length > 0" class="project-cards-grid">
      <div 
        *ngFor="let proyecto of proyectos" 
        class="project-card" 
        [class.is-favorito]="esFavorito(proyecto)">
        
        <!-- Bot√≥n de favorito -->
        <button 
          class="btn-favorito" 
          (click)="toggleFavorito(proyecto, $event)"
          [class.active]="esFavorito(proyecto)"
          [title]="esFavorito(proyecto) ? 'Quitar de favoritos' : 'Marcar como favorito'"
          type="button">
          {{ esFavorito(proyecto) ? '‚≠ê' : '‚òÜ' }}
        </button>

        <!-- Contenido de la tarjeta -->
        <div class="card-content" [routerLink]="['/board']" [queryParams]="{id: proyecto.id}">
          <span class="card-icon">{{ getIcono(proyecto) }}</span>
          <h3>{{ proyecto.nombre }}</h3>
          <p *ngIf="proyecto.descripcion" class="project-description">{{ proyecto.descripcion }}</p>
          <span class="project-status" [ngClass]="'status-' + getEstadoClass(proyecto.estado)">
            {{ proyecto.estado }}
          </span>
        </div>
      </div>
    </div>

    <div *ngIf="!isLoading && proyectos.length === 0" class="empty-state">
      <p>üìÇ No hay proyectos disponibles</p>
      <p class="hint">Crea tu primer proyecto usando el bot√≥n superior</p>
    </div>
  </section>
</div>

<!-- MODAL DE CREAR PROYECTO -->
<div class="modal-overlay" *ngIf="mostrarModal" (click)="cerrarModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>üìÇ Nuevo Proyecto</h3>
      <button class="btn-close" (click)="cerrarModal()">√ó</button>
    </div>
    
    <form (ngSubmit)="guardarProyecto()">
      <div class="form-group">
        <label>Nombre del Proyecto *</label>
        <input 
          type="text" 
          [(ngModel)]="nuevoProyecto.nombre" 
          name="nombre"
          class="form-control" 
          placeholder="Ej: Desarrollo Web App"
          required>
      </div>

      <div class="form-group">
        <label>Descripci√≥n</label>
        <textarea 
          [(ngModel)]="nuevoProyecto.descripcion" 
          name="descripcion"
          class="form-control" 
          rows="3"
          placeholder="Describe brevemente el proyecto..."></textarea>
      </div>

      <div class="row-grid">
        <div class="form-group">
          <label>Fecha Inicio</label>
          <input 
            type="date" 
            [(ngModel)]="nuevoProyecto.fecha_inicio" 
            name="fecha_inicio"
            class="form-control">
        </div>

        <div class="form-group">
          <label>Fecha Fin (Estimada)</label>
          <input 
            type="date" 
            [(ngModel)]="nuevoProyecto.fecha_fin" 
            name="fecha_fin"
            class="form-control">
        </div>
      </div>

      <div class="modal-actions">
        <button type="button" class="btn btn-secondary" (click)="cerrarModal()">
          Cancelar
        </button>
        <button type="submit" class="btn btn-primary">
          Crear Proyecto
        </button>
      </div>
    </form>
  </div>
</div>