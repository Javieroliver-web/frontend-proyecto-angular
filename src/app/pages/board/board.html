<div class="board-container" *ngIf="proyecto">
  <div class="board-header">
    <h1>{{ proyecto.nombre }}</h1>
    <p>{{ proyecto.descripcion }}</p>
  </div>

  <div class="kanban-board">
    <div class="kanban-column" 
         (dragover)="onDragOver($event)" 
         (drop)="onDrop($event, 'pendiente')">
      <h3>Pendientes <button (click)="abrirModalCrear('pendiente')">+</button></h3>
      
      <div class="task-card" *ngFor="let t of columnas.pendiente"
           draggable="true" 
           (dragstart)="onDragStart($event, t)"
           (click)="abrirModalEditar(t)">
        <h4>{{ t.titulo }}</h4>
        <small *ngIf="t.fecha_limite">ðŸ“… {{ t.fecha_limite }}</small>
      </div>
    </div>

    <div class="kanban-column" 
         (dragover)="onDragOver($event)" 
         (drop)="onDrop($event, 'en_progreso')">
      <h3>En Curso <button (click)="abrirModalCrear('en_progreso')">+</button></h3>
      
      <div class="task-card" *ngFor="let t of columnas.en_progreso"
           draggable="true" 
           (dragstart)="onDragStart($event, t)"
           (click)="abrirModalEditar(t)">
        <h4>{{ t.titulo }}</h4>
        <small *ngIf="t.fecha_limite">ðŸ“… {{ t.fecha_limite }}</small>
      </div>
    </div>

    <div class="kanban-column" 
         (dragover)="onDragOver($event)" 
         (drop)="onDrop($event, 'completada')">
      <h3>Completadas</h3>
      
      <div class="task-card completed" *ngFor="let t of columnas.completada"
           draggable="true" 
           (dragstart)="onDragStart($event, t)"
           (click)="abrirModalEditar(t)">
        <h4>{{ t.titulo }}</h4>
        <small *ngIf="t.fecha_limite">ðŸ“… {{ t.fecha_limite }}</small>
      </div>
    </div>
  </div>
</div>

<div class="modal" [class.show]="modalOpen">
  <div class="modal-content">
    <h2>{{ isEditMode ? 'Editar' : 'Nueva' }} Tarea</h2>
    <input [(ngModel)]="currentTarea.titulo" placeholder="TÃ­tulo" class="form-control">
    <textarea [(ngModel)]="currentTarea.descripcion" placeholder="DescripciÃ³n" class="form-control"></textarea>
    
    <input type="date" [(ngModel)]="currentTarea.fecha_limite" class="form-control">
    
    <div class="modal-actions">
        <button (click)="guardarTarea()" class="btn-primary">Guardar</button>
        <button (click)="eliminarTarea(currentTarea.id)" *ngIf="isEditMode" class="btn-danger">Eliminar</button>
        <button (click)="modalOpen = false" class="btn-secondary">Cancelar</button>
    </div>
  </div>
</div>